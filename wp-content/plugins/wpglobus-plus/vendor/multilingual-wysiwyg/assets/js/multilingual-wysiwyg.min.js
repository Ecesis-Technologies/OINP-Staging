jQuery(document).ready(function(i){var u;"undefined"!=typeof MultilingualWYSIWYG&&(u={started:!1,formSubmited:!1,updateContent:!0,editors:{},listBox:{},submitElements:{},buttonTypes:{},parseBool:function(t){return!/^(false|0)$/i.test(t)&&!!t},isStarted:function(){return u.parseBool(MultilingualWYSIWYG.started)},isNum:function(t){return/^\d+$/.test(t)},isUpdateContent:function(){return u.updateContent},isEnabledEditorID:function(t){if(/\*/.test(u.get("editor_id"))){var e=u.get("editor_id")[0].replace("*","");if(0==e.length)return!0;if(-1==t.indexOf(e))return!1}else if(-1==u.get("editor_id").indexOf(t))return!1;return!0},initEditor:function(t){return("WPGlobus"!=u.get("provider")||"undefined"==typeof WPGlobusPlusTinyMCE)&&("object"==typeof t&&void 0!==t.id&&(void 0===u.editors[t.id]&&(!!u.isEnabledEditorID(t.id)&&(u.editors[t.id]={},u.editors[t.id].content="",u.editors[t.id].language=u.getDefaultValue(),!0))))},getTinyMCEEditors:function(){return tinyMCE.editors},getExistenceEditors:function(){return u.getTinyMCEEditors()},getEditors:function(){return u.getEditor()},getEditor:function(t){if(void 0===t)return!_.isEmpty(u.editors)&&u.editors;var e;if("string"==typeof t)e=t;else{if("object"!=typeof t)return!1;e=t.id}return void 0!==u.editors[e]&&u.editors[e]},getEditorContent:function(t){return u.getEditor(t).content},setEditorContent:function(t,e){u.getEditor(t).content=e},getEditorLanguages:function(){i.each(u.getEditor(),function(t,e){console.log("editor ID::",t," > language::",e.language)})},getEditorLanguage:function(t){return u.getEditor(t).language},setEditorLanguage:function(t,e){return"object"==typeof t&&void 0!==t.id&&(void 0!==u.editors[t.id]&&(u.editors[t.id].language=e))},set:function(t,e){MultilingualWYSIWYG.data[t]=e},get:function(t){if(void 0!==MultilingualWYSIWYG.data[t])return MultilingualWYSIWYG.data[t]},getVersion:function(){return MultilingualWYSIWYG.version},start:function(){return"undefined"!=typeof tinymce&&("WPGlobus"==u.get("provider")&&(MultilingualWYSIWYG.started=!0,u.init(),u.addSwitcherListBox(),void setTimeout(function(){u.attachListeners()},1e3)))},init:function(){u.initData(),u.initListBox(),u.initButtonTypes(),u.initEditors()},initData:function(){var t,e=u.get("editor_id");"string"==typeof e&&((t=[]).push(e),u.set("editor_id",t))},initListBox:function(){u.listBox={};var t,e=[],n=u.get("languages"),i=0;for(t in n){var o=t;u.isNum(t)&&(o=n[t]),e.push({text:n[t],value:o}),0==i&&(u.listBox.defaultValue=o,u.listBox.defaultText=n[t]),i++}u.listBox.values=e},initButtonTypes:function(){u.buttonTypes.listbox={buttonClass:"multilingual-wysiwyg-listbox"}},initEditors:function(){i(document).on("tinymce-editor-init",function(t,e){var n=i(document).triggerHandler("MultilingualWysiwyg-TinymceEditorInit",{editor:e});void 0===n||n?u.initEditor(e)&&(u.editors[e.id].content=e.getContent(),e.setContent(u.getTranslation(e,u.get("defaultLanguage"))),e.on("keyup",_.debounce(u.updateEditorContent,300)),i("#"+e.id).on("input keyup",_.debounce(u.updateEditorContent,300)),setTimeout(function(){i("#"+e.iframeElement.id).css({"border-left":"3px solid blue",width:"99%"})},400)):setTimeout(function(){i("."+u.buttonTypes.listbox.buttonClass+"-"+e.id).css({display:"none"})},400)})},getValues:function(){if(u.listBox.values)return u.listBox.values},getDefaultText:function(){return u.listBox.defaultText},getDefaultValue:function(){return u.listBox.defaultValue},getMLString:function(t,e,n){var i="";return"WPGlobus"==u.get("provider")&&(i=WPGlobusCore.getString(u.getEditorContent(t),e,n)),i},getTranslation:function(t,e){var n=[];return"WPGlobus"==u.get("provider")&&(n=WPGlobusCore.getTranslations(u.getEditorContent(t))),void 0===n[e]?"":n[e]},addSwitcherListBox:function(){tinymce.PluginManager.add("ml_tinymce_language_select_button",function(n,t){u.isEnabledEditorID(n.id)&&n.addButton("ml_tinymce_language_select_button",{type:"listbox",text:u.getDefaultText(),icon:!1,onselect:function(t){var e=this.value();u.getEditorLanguage(n)==e||(u.updateContent=!1,u.setEditorLanguage(n,e),n.setContent(u.getTranslation(n,e)))},values:u.getValues(),onPostRender:function(){u.getDefaultValue()&&this.value(u.getDefaultValue()),u.afterPostRender(this,n)}})})},afterPostRender:function(t,e){t=t._id;"string"==typeof t&&1==i(t="#"+t).length&&(u.setListboxCSS(t),u.addClass(t,e))},addClass:function(t,e){var n=u.buttonTypes.listbox.buttonClass;i(t).addClass(n),i(t).addClass(n+"-"+e.id)},setListboxCSS:function(t){i(t).attr("data-multilingual-wysiwyg-styled","true"),i(t).css({"border-left":"3px solid blue"})},attachListeners:function(){setTimeout(function(){i.each(u.get("submit_element"),function(t,e){return 0==e.length||void i(document).on("mouseenter",e,function(t){u.updateContent=!1,i.each(u.getEditors(),function(t,e){null==tinymce.get(t)||tinymce.get(t).isHidden()?(i("#"+t).val(e.content),i("#"+t+"-tmce").trigger("click")):tinymce.get(t).setContent(e.content,{format:"raw"})})}).on("mouseleave",e,function(t){u.formSubmited||(u.updateContent=!1,i.each(u.getEditors(),function(t,e){var n=u.getTranslation(t,u.getEditorLanguage(t));null==tinymce.get(t)||tinymce.get(t).isHidden()?i("#"+t).val(n):tinymce.get(t).setContent(n,{format:"raw"})}))}).on("click",e,function(t){u.formSubmited=!0})})},500)},updateEditorContent:function(t){var e;!t.selectionChange||u.isUpdateContent()?void 0!==t.target&&("tinymce"==(e=t.target.id)&&(e=t.target.dataset.id),t=null==tinymce.get(e)||tinymce.get(e).isHidden()?i("#"+e).val():tinymce.get(e).getContent({format:"raw"}),u.setEditorContent(e,u.getMLString(e,t,u.getEditorLanguage(e)))):u.updateContent=!0}},(MultilingualWYSIWYG=i.extend({},MultilingualWYSIWYG,u)).start())});