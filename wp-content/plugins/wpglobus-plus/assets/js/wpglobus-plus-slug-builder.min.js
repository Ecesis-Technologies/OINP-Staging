!function(m){"use strict";var b={option:{},real_slug:m("#post_name"),revert_slug:m("#post_name").val(),currentExtraLanguage:void 0,promise:m.when(),init:function(e){b.option=m.extend(b.option,e),b.localizePermalink(!0),this.attachListeners(),b.yoastSettings()},yoastSettings:function(){WPGlobusAdmin.builder.language!=WPGlobusCoreData.default_language&&"YoastSEO"==WPGlobusPlusSlug.yoastSeo&&setTimeout(function(){m(".wpseo-metabox-root button").each(function(e,a){-1!=m(a).attr("class").indexOf("Button__BaseButton-")&&m(a).addClass("wpglobus-plus-base-button")}),m(document).on("click",".wpglobus-plus-base-button",function(e){setTimeout(function(){m("#snippet-editor-field-slug").prop("disabled",!0)},500)})},1500)},localizePermalink:function(e){var a,l;void 0===e&&(e=!1),"gutenberg"==WPGlobusPlusSlug.builderID?b.blockEditorInit():WPGlobusCoreData.default_language!=WPGlobusPlusSlug.builder.language&&(WPGlobusPlusSlug.homeURL,a=m("#sample-permalink").html(),l=new RegExp(WPGlobusPlusSlug.homeURL,"g"),l=a.replace(l,WPGlobusPlusSlug.homeLocalizedURL),e?(null!==WPGlobusPlusSlug.slug&&(l=l.replace(new RegExp(m("#post_name").val()),WPGlobusPlusSlug.slug)),m("#sample-permalink").html(l),null===WPGlobusPlusSlug.slug&&null===WPGlobusPlusSlug.shortenSlug||(m("#editable-post-name-full").text(WPGlobusPlusSlug.slug),m("#editable-post-name").text(WPGlobusPlusSlug.shortenSlug))):(l=l.replace(new RegExp(m("#post_name").val()),m("#editable-post-name-full").text()),m("#sample-permalink").html(l)))},attachListeners:function(){"gutenberg"==WPGlobusPlusSlug.builderID?m(document).on("blur",".wpglobus-editable-post-name",function(e){var a=m(this),l=a.val();l!=a.data("old-name")&&(0<l.length?b.getSamplePermalink(a.data("post-id"),a.data("language"),l):b.remove(a.data("post-id"),a.data("language")))}):(m(document).ajaxSend(function(e,a,l){var t;void 0!==l.data&&(void 0!==b.currentExtraLanguage||void 0!==(t=m('input[name="wpglobus_language"]').val())&&t!=WPGlobusCoreData.default_language)&&-1!=l.data.indexOf("action=sample-permalink")&&(b.currentExtraLanguage=t)}),m(document).ajaxComplete(function(e,a,l){void 0!==b.currentExtraLanguage&&-1!=l.data.indexOf("action=sample-permalink")&&(b.save(WPGlobusAdmin.$_get.post,b.currentExtraLanguage,m("#editable-post-name-full").text()),b.real_slug.val(b.revert_slug),b.localizePermalink(!1),b.currentExtraLanguage=void 0)}))},getSamplePermalink:function(a,l,e){m.post(ajaxurl,{action:"sample-permalink",post_id:a,new_slug:e,new_title:m("#title").val(),samplepermalinknonce:m("#samplepermalinknonce").val()},function(e){e=e.match(/<span id="editable-post-name-full">.*<\/span>/);void 0!==e[0]&&(e=(e=e[0].replace('<span id="editable-post-name-full">',"")).replace("</span>",""),b.save(a,l,e),m("#editable-post-name-"+l).val(e))})},remove:function(a,l){b.promise=b.promise.then(function(){var e={action:"wpglobus-remove-name"};return e.post_id=a,e.language=l,m.ajax({beforeSend:function(){void 0!==b.beforeSend&&b.beforeSend(e)},type:"POST",url:WPGlobusAdmin.ajaxurl,data:{action:WPGlobusPlusSlug.process_ajax,order:e},dataType:"json"})},function(){}).then(function(e){"success"==e.status&&m("#editable-post-name-"+e.language).data("old-name",e.new_name)})},save:function(a,l,t){b.promise=b.promise.then(function(){var e={action:"wpglobus-save-name"};return e.post_id=a,e.language=l,e.new_name=t,m.ajax({beforeSend:function(){void 0!==b.beforeSend&&b.beforeSend(e)},type:"POST",url:WPGlobusAdmin.ajaxurl,data:{action:WPGlobusPlusSlug.process_ajax,order:e},dataType:"json"})},function(){}).then(function(e){"success"==e.status&&(m("#editable-post-name-"+e.language).data("old-name",e.new_name),m(document).trigger("wpglobus-sample-permalink:done",[e,e.language]))})},blockEditorInit:function(){WPGlobusCoreData.enabled_languages.map(e=>{b.store.setSlug(e,WPGlobusPlusSlug.postSlugs[e])})},store:{slug:[],getSlug(e){return void 0===e?b.store.slug:void 0===b.store.slug[e]?null:b.store.slug[e]},setSlug(e,a){b.store.slug[e]=a}},getStore:function(){return b.store},getPermalinkTemplates:function(){return WPGlobusPlusSlug.permalinkTemplates},getPermalink:function(e){var a=WPGlobusPlusSlug.permalinkTemplates[e],e=b.store.getSlug(e);return null===(e=""===e?b.store.getSlug(WPGlobusCoreData.default_language):e)?a:a.replace(/%\S+%/,e)},isHomePage:function(){return WPGlobusPlusSlug.postID===WPGlobusPlusSlug.pageOnFront},getPublishStatus:function(e){return"undefined"==typeof WPGlobusPlusPublish||void 0===WPGlobusPlusPublish.getStatus(e)?"publish":WPGlobusPlusPublish.getStatus(e)},getComponent:function(e){var i=wp.element.createElement,p=wp.element.useState,c=wp.element.useEffect,d=wp.element.useCallback;wp.element.useContext;let{tagName:a="",...l}=e;var t;return"InputSlug"===a?t=i(e=>{const{className:a="",style:l={},placeholder:t="",language:u=WPGlobusCoreData.default_language}=e,[n,s]=p(""),o=d(async e=>{const{language:a,value:l}=e;var t;if(void 0===l){if(null!==b.store.getSlug(a))return void s(b.store.getSlug(a));t="getSlug"}else if(t="updateSlug",l===b.store.getSlug(a))return;e={action:t,post_id:WPGlobusPlusSlug.postID,language:a};"updateSlug"===t&&(e.value=l),m.ajax({type:"POST",url:WPGlobusPlusSlug.ajaxurl,data:{action:WPGlobusPlusSlug.process_ajax,order:e},dataType:"json"}).done(function(e){"success"===e.status&&(s(e.slug),b.store.setSlug(a,e.slug))}).fail(function(e){}).always(function(e,a){})},[]);c(()=>{o({language:u})},[]);let r="components-text";""!==a&&(r+=" "+a);let g="";u===WPGlobusCoreData.default_language&&(g="disabled");return i("input",{type:"text",value:n,className:r,style:l,disabled:g,placeholder:t,onChange:e=>{s(()=>{return e.target.value.replace(/\s{2}/g," ").replace(/\s/g,"-")})},onBlur:e=>{o({language:u,value:n})}})},{style:l.style,title:"title",className:l.className,language:l.language,placeholder:l.placeholder},"currentStatus"):"ExternalButton"===a&&(t=i(e=>{let{className:t="",style:a={},target:u="",children:n="",language:s=WPGlobusCoreData.default_language}=e;const[l,o]=p({children:n.replace("{{externalUrl}}",b.getPermalink(s)),href:"publish"===b.getPublishStatus(s)?n.replace("{{externalUrl}}",b.getPermalink(s)):"#",tagName:"publish"===b.getPublishStatus(s)?"a":"span",classes:""===t?"":t,target:"publish"===b.getPublishStatus(s)?u:null});return c(()=>(m(document).on("ajaxComplete",function(e,a,l){void 0!==a.responseJSON&&void 0!==a.responseJSON.payload&&s===a.responseJSON.payload.language&&["getSlug","updateSlug","set_status"].forEach(l=>{if(l===a.responseJSON.payload.action)return"publish"===b.getPublishStatus(s)?o(e=>{var a={tagName:"a",classes:"components-a "+t,target:u};return"set_status"===l?a.href=e.children:(a.children=n.replace("{{externalUrl}}",b.getPermalink(s)),a.href=a.children),{...e,...a}}):o(e=>{var a={tagName:"span",classes:"components-span "+t,href:null,target:null};return"set_status"===l||(a.children=n.replace("{{externalUrl}}",b.getPermalink(s))),{...e,...a}}),!1})}),()=>{m(document).off("ajaxComplete")}),[]),i(l.tagName,{href:l.href,className:l.classes,target:l.target,style:a},l.children)},{className:l.className,style:l.style,isSmall:l.isSmall,isPrimary:l.isPrimary,href:l.href,target:l.target,language:l.language},l.children)),t}};WPGlobusPlusSlug=m.extend({},WPGlobusPlusSlug,b),WPGlobusPlusSlug.init()}(jQuery);