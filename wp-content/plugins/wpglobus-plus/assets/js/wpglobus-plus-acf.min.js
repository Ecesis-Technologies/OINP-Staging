!function(i){"use strict";var l;"undefined"!=typeof WPGlobusCoreData&&"undefined"!=typeof WPGlobusPlusAcf&&(l={option:{language:WPGlobusCoreData.default_language,content:"",activeClass:"mce-active"},language:{},content:{},disabledEditor:!1,acfPro:!1,savedPost:!1,__getAcfEditorsID:function(){"object"==typeof WPGlobusPlusAcf.content&&i.each(WPGlobusPlusAcf.content,function(e,t){console.log(e)})},__getContent:function(){"object"==typeof WPGlobusPlusAcf.content&&i.each(WPGlobusPlusAcf.content,function(e,t){console.log("content of: ",e),console.log(t)})},isAcfPro:function(){return l.acfPro},parseBool:function(e){return!/^(false|0)$/i.test(e)&&!!e},isRemoveEmptyP:function(){return l.parseBool(WPGlobusPlusAcf.removeEmptyP)},initWysiwygWithBuilder:function(e){"undefined"!=typeof WPGlobusAcf&&(tinymce.PluginManager.add("wpglobus_plus_acf_separator",function(e,t){var n;(0<=e.id.indexOf("wysiwyg-acf-field")||0<=e.id.indexOf("acf-editor-"))&&("function"==typeof WPGlobusAcf.registerField&&(n=WPGlobusAcf.registerField(i("#"+e.id).attr("name")),l.disabledEditor=!1,WPGlobusAcf.isDisabledField(n)&&(l.disabledEditor=!0),WPGlobusAcf.isVendorAcfField(n)||(l.disabledEditor=!0)),l.isDisabledEditor()||e.addButton("wpglobus_plus_acf_separator",{text:"",icon:"wpglobus-plus-globe"}))}),tinymce.PluginManager.add("wpglobus_plus_acf_button_"+WPGlobusAdmin.builder.language,function(e,t){if("content"!=e.id&&-1!=e.id.indexOf("acf-")){if("function"==typeof WPGlobusAcf.registerField){var n=i("#"+e.id).attr("name");if(!WPGlobusAcf.isVendorAcfField(n))return}_.delay(function(){i(e.iframeElement).addClass("wpglobus-translatable").css({width:"99%"}),i("#"+e.id).addClass("wpglobus-translatable")},2e3),e.addButton("wpglobus_plus_acf_button_"+WPGlobusAdmin.builder.language,{text:WPGlobusCoreData.en_language_name[WPGlobusAdmin.builder.language],icon:!1,tooltip:"Current language",value:WPGlobusAdmin.builder.language,classes:"widget btn wpglobus-plus-acf-button active wpglobus-plus-acf-button-"+WPGlobusAdmin.builder.language+" wpglobus-plus-acf-button-"+e.id,onclick:function(){}})}}))},init:function(e){l.option=i.extend(l.option,e),"undefined"!=typeof WPGlobusAcf&&(l.acfPro=l.parseBool(WPGlobusAcf.pro)),"undefined"!=typeof WPGlobusAdmin&&void 0!==WPGlobusAdmin.builder&&WPGlobusAdmin.builder.builder_page?l.initWysiwygWithBuilder():!1!==l.addButtons()&&(l.isAcfPro()?i(document).on("wpglobus_before_save_post",function(e,t){l.savedPost||(l.savedPost=!0,i.each(l.content,function(e,t){null==tinymce.get(e)||tinymce.get(e).isHidden()?(i("#"+e).val(t),i("#"+e+"-tmce").click()):tinymce.get(e).setContent(t,{format:"raw"})}))}):(l.setValidation(),void 0===acf.validation.disabled?i(document).on("wpglobus_before_save_post",function(e,t){i.each(l.content,function(e,t){tinymce.get(e).setContent(t)})}):i(document).on("wpglobus_before_save_post",function(e,t){acf.validation.disabled||acf.validation.run(),acf.validation.status&&i.each(l.content,function(e,t){tinymce.get(e).setContent(t)})})),l.editorsInit())},update:function(e){var t;void 0!==e.target&&("tinymce"==(t=e.target.id)&&(t=e.target.dataset.id),void 0!==l.content[t]&&(e=null==tinymce.get(t)||tinymce.get(t).isHidden()?i("#"+t).val():tinymce.get(t).getContent({format:"raw"}),l.content[t]=WPGlobusCore.getString(l.content[t],e,l.language[t])))},editorsInit:function(){l.acfPro&&i(document).on("tinymce-editor-init",function(e,t){-1!=t.id.indexOf("acf-editor-")&&(t.on("nodechange keyup",_.debounce(l.update,1e3)),i("#"+t.id).on("input keyup",_.debounce(l.update,1e3)))})},setValidation:function(){acf.validation.disabled||i(document).on("acf/validate_field",function(e,t){var n,t=i(t),o="",a=!0;if(t.hasClass("field_type-textarea"))t.data("validation",!1),n=t.find("textarea").attr("id"),o=i("#"+n).val();else{if(!t.hasClass("field_type-text"))return;t.data("validation",!1),n=t.find("input").attr("id"),o=i("#"+n).val()}""!=o&&(o=WPGlobusCore.getTranslations(o),i.each(WPGlobusCoreData.enabled_languages,function(e,t){return""==o[t]?a=!1:void(a=!0)}),a?(t.data("validation",!0),i("#wpglobus-dialog-start-"+n).removeClass("wpglobus_dialog_error")):i("#wpglobus-dialog-start-"+n).addClass("wpglobus_dialog_error").shake(3,7,800))})},saveContent:function(e,t){var n=WPGlobusPlusAcf.isRemoveEmptyP()?e.getContent().replace(/<p>\s*<\/p>/g,""):e.getContent();l.content[e.id]=WPGlobusCore.getString(l.content[e.id],n,t)},getTranslation:function(e,t){return WPGlobusCore.getTranslations(l.content[e.id])[t]},removeClass:function(e){i(".mce-wpglobus-plus-acf-button-"+e).removeClass(l.option.activeClass)},initContent:function(e){var n=e.getContent(),o=WPGlobusCore.getTranslations(n);i.each(o,function(e,t){WPGlobusPlusAcf.isRemoveEmptyP()&&(o[e]=o[e].replace(/<p>\s*<\/p>/g,"")),WPGlobusCoreData.default_language,n=WPGlobusCore.getString(n,o[e],e)}),l.content[e.id]=n},isDisabledEditor:function(){return l.disabledEditor},addButtons:function(){l.disabledEditor=!1,tinymce.PluginManager.add("wpglobus_plus_acf_separator",function(e,t){var n;0<=e.id.indexOf("wysiwyg-acf-field")||0<=e.id.indexOf("acf-editor-")?"undefined"!=typeof WPGlobusAcf&&"function"==typeof WPGlobusAcf.registerField&&(n=WPGlobusAcf.registerField(i("#"+e.id).attr("name")),WPGlobusAcf.isDisabledField(n)&&(l.disabledEditor=!0),WPGlobusAcf.isVendorAcfField(n)||(l.disabledEditor=!0)):l.disabledEditor=!0,l.isDisabledEditor()?l.disabledEditor=!1:e.addButton("wpglobus_plus_acf_separator",{text:"",icon:"wpglobus-plus-globe"})}),i.each(WPGlobusCoreData.enabled_languages,function(e,a){tinymce.PluginManager.add("wpglobus_plus_acf_button_"+a,function(o,e){var t="";if(0<=o.id.indexOf("wysiwyg-acf-field")||0<=o.id.indexOf("acf-editor-")){if("undefined"!=typeof WPGlobusAcf&&"function"==typeof WPGlobusAcf.registerField){var n=i("#"+o.id).attr("name");if(WPGlobusAcf.isDisabledField(n))return!1;if(!WPGlobusAcf.isVendorAcfField(n))return!1}a==WPGlobusCoreData.default_language&&(_.delay(function(){i(o.iframeElement).addClass("wpglobus-translatable").css({width:"99%"}),i("#"+o.id).addClass("wpglobus-translatable")},2e3),t=" active",_.delay(function(){l.initContent(o),l.language[o.id]=l.option.language,tinymce.get(o.id).setContent(l.getTranslation(o,a)),o.on("blur",function(e,t){l.saveContent(o,l.language[o.id])})},1e3))}o.addButton("wpglobus_plus_acf_button_"+a,{text:WPGlobusCoreData.en_language_name[a],icon:!1,tooltip:"Select "+WPGlobusCoreData.en_language_name[a]+" language",value:a,classes:"widget btn wpglobus-plus-acf-button"+t+" wpglobus-plus-acf-button-"+a+" wpglobus-plus-acf-button-"+o.id,onclick:function(){var e=i(this),t=e[0]._id,n=WPGlobusCoreData.default_language;void 0!==e[0]._value?n=e[0]._value:void 0!==e[0].settings.value?n=e[0].settings.value:console.log("Language value not defined. It was set to default."),l.removeClass(o.id),i("#"+t).addClass(l.option.activeClass),l.saveContent(o,l.language[o.id]),l.language[o.id]=n,o.setContent(l.getTranslation(o,l.language[o.id]))}})})})}},(WPGlobusPlusAcf=i.extend({},WPGlobusPlusAcf,l)).init())}(jQuery);