jQuery(document).ready(function(n){"use strict";var i={postType:"",spinnerClass:".spinner",dialogBeforeOpen:function(o){n(".wpglobus-button-save").css({visibility:"hidden"})},dialogClose:function(o){n(".wpglobus-button-save").css({visibility:""})},setPostType:function(){var o,t;void 0!==WPGlobusPlusTaxonomies.$_GET["post-type"]?(o=WPGlobusPlusTaxonomies.$_GET["post-type"],0==n("#tabs-taxonomies li.tab-post-type-"+o).length?(i.postType="post",t=location.search.replace("post-type="+o,"post-type=post"),history.pushState({},"","admin.php"+t)):i.postType=o):i.postType="post"},getPostType:function(){return i.postType},init:function(){void 0!==WPGlobusPlusTaxonomies.pagenow&&"options-permalink.php"==WPGlobusPlusTaxonomies.pagenow&&i.initPermalinkPage(),"taxonomies"==WPGlobusPlus.tab&&(n(WPGlobusPlusTaxonomies.setContentId).html(WPGlobusPlusTaxonomies.contentHtml),i.setPostType(),this.start(),this.attachListeners())},initPermalinkPage:function(){},tabActivate:function(o,t,s){s=s||!1;var a,e=n(t.oldTab).data("post-type")||!1,t=(t=n(t.newTab).data("post-type")||!1)||i.getPostType();n("#tabs-taxonomies li").css({"font-weight":""}),n("#tabs-taxonomies li.tab-post-type-"+t).css({"font-weight":"bold"}),s||(-1==(s=location.search).indexOf("&post-type=")?(a="admin.php"+s+"&post-type="+t,history.pushState({},"",a)):e&&(a="admin.php"+(s=s.replace("post-type="+e,"post-type="+t)),history.pushState({},"",a)))},start:function(){n("#tabs-taxonomies").tabs({create:function(o,t){i.tabActivate(o,t,!0)},activate:function(o,t){i.tabActivate(o,t)}}).addClass("ui-tabs-vertical ui-helper-clearfix"),n("#tabs-taxonomies li").removeClass("ui-corner-top").addClass("ui-corner-left"),setTimeout(function(){var o,t;n(".wpglobus-plus-section").removeClass("one-col"),n("#post-type-"+i.postType).click(),""==location.hash?n(".wpglobus-plus-taxonomies-terms-box").addClass("hidden"):"post"!=i.getPostType()&&(o=n("body"),1==(t=n(location.hash)).length&&o.animate({scrollTop:t.offset().top-o.offset().top+o.scrollTop()}))},300),i.setTooltip()},setTooltip:function(){n(".wpglobus-plus-taxonomies-help").tooltip({position:{my:"center bottom-20",at:"center top",using:function(o,t){1<n(".ui-tooltip.ui-widget").length||(n(this).css(o),n("<div>").addClass("arrow").addClass(t.vertical).addClass(t.horizontal).appendTo(this))}}})},attachListeners:function(){n(document).on("keyup",".wpglobus-plus-taxonomy-field",function(o){var t=n(this),s=t.val();s.match(/\s/);null!==s.match(/\s/)&&t.val(s.replace(/\s/g,"-"))}),n(document).on("change",".wpglobus-plus-taxonomy-field",function(o){var t=n(this),s=t.data("source-id"),a=t.data("language"),e=t.val();a!=WPGlobusCoreData.default_language&&(""==e&&(e=t.data("slug-default"),t.val(e)),n(s).val(WPGlobusCore.getString(n(s).val(),e,a)))}),n(document).on("click",".wpglobus-plus-taxonomies-toggle",function(o){var t=n(this);n("#wpglobus-plus-taxonomies-"+t.data("taxonomy")+"-terms-box").hasClass("hidden")?(n(".wpglobus-plus-taxonomies-terms-box").addClass("hidden"),n("#wpglobus-plus-taxonomies-"+t.data("taxonomy")+"-terms-box").removeClass("hidden")):n(".wpglobus-plus-taxonomies-terms-box").addClass("hidden")}),n(document).on("click",".wpglobus-plus-taxonomies-hide-empty-terms",function(o){var s=n(this);s.prop("checked")?n("#wpglobus-plus-taxonomies-"+s.data("taxonomy")+"-terms-box .wpglobus-taxonomy-term-source").each(function(o,t){t=n(t);""==t.val()&&(t=t.data("term-id"),n("#wpglobus-plus-taxonomies-"+s.data("taxonomy")+"-terms-box #taxonomy-term-"+t).addClass("hidden"))}):n("#wpglobus-plus-taxonomies-"+s.data("taxonomy")+"-terms-box .wpglobus-plus-taxonomies-term").removeClass("hidden")}),n(document).on("dblclick",".post-type-tab",function(o){n(".wpglobus-taxonomy-source").toggleClass("hidden"),n(".wpglobus-taxonomy-term-source").toggleClass("hidden")}),n(document).on("click",".post-type-save",function(o){var t=n(this),e={post_type:{},taxonomy:{}};n(t.data("tab-id")+" .wpglobus-taxonomy-source").each(function(o,t){var s=n(t),t=s.data("post-type");void 0!==t&&(e.post_type[t]={},e.post_type[t]=s.val());t=s.data("taxonomy");void 0!==t&&(e.taxonomy[t]={},e.taxonomy[t].slug=s.val())}),n(t.data("tab-id")+" .wpglobus-taxonomy-term-source").each(function(o,t){var s=n(t),a=s.data("taxonomy"),t=(s.data("term-slug"),"term_id_"+s.data("term-id"));void 0!==e.taxonomy[a]&&(void 0===e.taxonomy[a].term_slug&&(e.taxonomy[a].term_slug={}),void 0===e.taxonomy[a].term_slug[t]&&(e.taxonomy[a].term_slug[t]={}),e.taxonomy[a].term_slug[t]=s.val())}),i.ajax({action:"taxonomies-save",module:WPGlobusPlusTaxonomies.module,post_type:t.data("post-type"),data:e},i.beforeSend).done(function(o){}).fail(function(o){}).always(function(o,t){n(i.spinnerClass).css({visibility:"hidden"})})}),void 0!==WPGlobusPlusTaxonomies.$_GET.section&&"debug"==WPGlobusPlusTaxonomies.$_GET.section&&n(document).on("click",".wpglobus-plus-taxonomies-title",function(o){var t=n(this).data("id");n(".wpglobus-plus-taxonomies-debug-data-"+t).hasClass("hidden")?(n(".wpglobus-plus-taxonomies-debug-data").addClass("hidden"),n(".wpglobus-plus-taxonomies-debug-data-"+t).removeClass("hidden")):n(".wpglobus-plus-taxonomies-debug-data").addClass("hidden")}),void 0!==WPGlobusPlusTaxonomies.$_GET.section&&"rewrite_rules"==WPGlobusPlusTaxonomies.$_GET.section&&n(document).on("click",".wpglobus-plus-taxonomies-title",function(o){var t=n(this).data("id");n(".wpglobus-plus-taxonomies-rewrite_rules-data-"+t).hasClass("hidden")?(n(".wpglobus-plus-taxonomies-rewrite_rules-data").addClass("hidden"),n(".wpglobus-plus-taxonomies-rewrite_rules-data-"+t).removeClass("hidden")):n(".wpglobus-plus-taxonomies-rewrite_rules-data").addClass("hidden")})},beforeSend:function(){n(i.spinnerClass).css({visibility:"visible"})},ajax:function(o,t){return n.ajax({beforeSend:function(){void 0!==t&&t()},type:"POST",url:ajaxurl,data:{action:WPGlobusPlusTaxonomies.process_ajax,order:o},dataType:"json"})}};WPGlobusPlusTaxonomies=n.extend({},WPGlobusPlusTaxonomies,i),WPGlobusPlusTaxonomies.init()});